---
title: "Final Project"
output: html_document
---

```{r setup environment, include=FALSE}
library(rsconnect)
library(shiny)
library(plotly)
library(ggplot2)
library(shinythemes)
library(dplyr)
library(readr)
```


```{r import data}
#load data
calls <- read.csv("https://data.cityofnewyork.us/resource/erm2-nwe9.csv", header = TRUE)
head(calls)
```

Below is an interactive graph where the user can compare the complaint types throughout specific boroughs.
```{r filter by complaint type}
complaint <- calls

# Define UI
ui2 <- fluidPage(theme = shinytheme("lumen"),
  titlePanel("Complaints by borough"),
  sidebarLayout(
    sidebarPanel(

      # Select borough to plot
      selectInput(inputId = "complaint_type", label = strong("borough"),
                  choices = unique(complaint$complaint_type),
                  selected = "MANHATTAN")
    ),

    # Output: Description, lineplot, and reference
    mainPanel(
      plotOutput(outputId = "barplot", height = "300px"),
      textOutput(outputId = "desc")
    )
  )
)

# Define server function
server2 <- function(input, output) {

  # Subset data
  complaint_comtype <- reactive({
    req(input$complaint_type)
    complaint %>%
      filter(complaint_type == input$complaint_type)
  })


  # Create barplot object the plotOutput function is expecting
   output$barplot <- renderPlot({
     color = "#434343"
    par(mar = c(4, 4, 1, 1))
    plot(table(complaint_comtype()$borough), main="Instances of complaint", xlab="borough", ylab = "Rate")
    }
  )
}

# Create Shiny object
shinyApp(ui = ui2, server = server2)

```
Below is an interactive graph to compare how one specific complaint type affects different boroughs.
```{r filter by complaint type}
borough <- calls

# Define UI
ui3 <- fluidPage(theme = shinytheme("lumen"),
  titlePanel("Complaints by borough"),
  sidebarLayout(
    sidebarPanel(

      # Select borough to plot
      selectInput(inputId = "borough", label = strong("borough"),
                  choices = unique(borough$borough),
                  selected = "MANHATTAN")
    ),

    # Output: Description, lineplot, and reference
    mainPanel(
      plotOutput(outputId = "barplot", height = "300px"),
      textOutput(outputId = "desc")
    )
  )
)

# Define server function
server3 <- function(input, output) {

  # Subset data
  complaint_borough <- reactive({
    req(input$borough)
    complaint %>%
      filter(borough == input$borough)
  })


  # Create barplot object the plotOutput function is expecting
   output$barplot <- renderPlot({
     color = "#434343"
    par(mar = c(4, 4, 1, 1))
    plot(table(complaint_borough()$complaint_type), main="Instances of complaint", xlab="complaint type", ylab = "Rate")
    }
  )
}

# Create Shiny object
shinyApp(ui = ui3, server = server3)

```

I will also be creating an interactive map which will show complaint status by borough. This will hopefully be useful to different agencies to see where they have the most issues, and if those issues are reseolved or not. They will also be able to compare issues by area over time with a interactive line plot. This will hopefully shed light on if there are recurring issues in certain areas over time.



```{python}
#interactive map here
```

```{r}
#interactive lineplot here
```

I would also like to compare most and least common complaints throughout NYC. From there it would be interesting to see if there is any statistical significance between boroughs for the most complaints.